[build]
target = "index.html"
release = true
dist = "dist"
public_url = "/fractalwonder/"
filehash = true
no_sri = true  # Disable SRI in development to avoid integrity mismatches during hot reload

[watch]
ignore = ["./worker-pkg"]

[serve]
addresses = ["127.0.0.1"]
port = 8080
open = false
no_autoreload = false

[serve.headers]
Cross-Origin-Opener-Policy = "same-origin"
Cross-Origin-Embedder-Policy = "require-corp"

[tools]
tailwindcss = "4.1.10"

# Build worker WASM before main build
[[hooks]]
stage = "pre_build"
command = "wasm-pack"
command_arguments = ["build", "fractalwonder-compute", "--target", "web", "--out-dir", "../worker-pkg", "--out-name", "fractalwonder_compute"]